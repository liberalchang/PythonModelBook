---
layout: doc
title: bisect æ¨¡å— - äºŒåˆ†æŸ¥æ‰¾ä¸æ’å…¥
permalink: /docs/stdlib/bisect/
category: stdlib
tags: [bisect, äºŒåˆ†æŸ¥æ‰¾, æœ‰åºæ•°ç»„, æ’åº, æ’å…¥]
description: Python bisect æ¨¡å—æä¾›äºŒåˆ†æŸ¥æ‰¾ç®—æ³•æ”¯æŒï¼Œç”¨äºåœ¨æœ‰åºæ•°ç»„ä¸­å¿«é€ŸæŸ¥æ‰¾å’Œæ’å…¥å…ƒç´ ï¼Œä¿æŒæ•°ç»„çš„æ’åºçŠ¶æ€
author: Python æ–‡æ¡£å›¢é˜Ÿ
date: 2024-01-15
updated: 2024-01-15
version: 1.0
difficulty: "ä¸­çº§"
---

# bisect æ¨¡å— - äºŒåˆ†æŸ¥æ‰¾ä¸æ’å…¥

## ğŸ“ æ¦‚è¿°

bisect æ¨¡å—ä¸ºæœ‰åºæ•°ç»„æä¾›äº†äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„æ”¯æŒã€‚è¯¥æ¨¡å—è‹±æ–‡å‘éŸ³ä¸º [baÉªËˆsekt]ï¼ˆå¯¹åŠåˆ†ã€äºŒç­‰åˆ†ï¼‰ï¼Œæ˜¯ Python æ ‡å‡†åº“ä¸­ä¸“é—¨ç”¨äºå¤„ç†æœ‰åºæ•°ç»„çš„é«˜æ•ˆå·¥å…·ã€‚å½“ä½ éœ€è¦åœ¨ Python ä¸­ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾åŠŸèƒ½æ—¶ï¼Œbisect æ¨¡å—æ˜¯é¦–é€‰è§£å†³æ–¹æ¡ˆã€‚

äºŒåˆ†æœç´¢æ˜¯ä¸€ç§åœ¨æœ‰åºæ•°ç»„ä¸­æŸ¥æ‰¾æŸä¸€ç‰¹å®šå…ƒç´ çš„æœç´¢ç®—æ³•ã€‚æœç´¢è¿‡ç¨‹ä»æ•°ç»„çš„ä¸­é—´å…ƒç´ å¼€å§‹ï¼Œå¦‚æœä¸­é—´å…ƒç´ æ­£å¥½æ˜¯è¦æŸ¥æ‰¾çš„å…ƒç´ ï¼Œåˆ™æœç´¢è¿‡ç¨‹ç»“æŸï¼›å¦‚æœæŸä¸€ç‰¹å®šå…ƒç´ å¤§äºæˆ–è€…å°äºä¸­é—´å…ƒç´ ï¼Œåˆ™åœ¨æ•°ç»„å¤§äºæˆ–å°äºä¸­é—´å…ƒç´ çš„é‚£ä¸€åŠä¸­æŸ¥æ‰¾ï¼Œè€Œä¸”è·Ÿå¼€å§‹ä¸€æ ·ä»ä¸­é—´å…ƒç´ å¼€å§‹æ¯”è¾ƒã€‚å¦‚æœåœ¨æŸä¸€æ­¥éª¤æ•°ç»„ä¸ºç©ºï¼Œåˆ™ä»£è¡¨æ‰¾ä¸åˆ°ã€‚è¿™ç§æœç´¢ç®—æ³•æ¯ä¸€æ¬¡æ¯”è¾ƒéƒ½ä½¿æœç´¢èŒƒå›´ç¼©å°ä¸€åŠã€‚

![](https://www.runoob.com/wp-content/uploads/2019/05/Binary_search_into_array.png)

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- æŒæ¡ bisect æ¨¡å—çš„åŸºæœ¬æ¦‚å¿µå’ŒäºŒåˆ†æŸ¥æ‰¾åŸç†
- å­¦ä¼šä½¿ç”¨ bisect_left å’Œ bisect_right æŸ¥æ‰¾æ’å…¥ä½ç½®
- ç†Ÿç»ƒä½¿ç”¨ insort_left å’Œ insort_right æ’å…¥å…ƒç´ 
- ç†è§£å·¦æ’å…¥å’Œå³æ’å…¥çš„åŒºåˆ«åŠåº”ç”¨åœºæ™¯
- æŒæ¡è‡ªå®šä¹‰æœ‰åºå®¹å™¨çš„å®ç°æ–¹æ³•
- å­¦ä¼šä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾è§£å†³å®é™…é—®é¢˜

## ğŸ“‹ å‰ç½®çŸ¥è¯†

- Python åŸºæœ¬è¯­æ³•å’Œæ•°æ®ç»“æ„
- åˆ—è¡¨æ“ä½œåŸºç¡€
- æ’åºç®—æ³•åŸºæœ¬æ¦‚å¿µ
- æ—¶é—´å¤æ‚åº¦åˆ†æ
- é¢å‘å¯¹è±¡ç¼–ç¨‹åŸºç¡€

## ğŸ” è¯¦ç»†å†…å®¹

### åŸºæœ¬æ¦‚å¿µ

bisect æ¨¡å—ä¸»è¦ç”¨äºæ“ä½œå‡åºæ’åºçš„æœ‰åºæ•°ç»„ã€‚è¯¥æ¨¡å—æä¾›çš„æ‰€æœ‰å‡½æ•°éƒ½å‡è®¾æ“ä½œçš„æ•°ç»„ `a` æ˜¯å‡åºæ’åºçš„æœ‰åºæ•°ç»„ã€‚

### æ ¸å¿ƒå‡½æ•°

#### bisect_right(a, x, lo=0, hi=len(a))
åœ¨æ•°ç»„ `a` ä¸­æ‰¾åˆ° `x` åº”è¯¥æ’å…¥çš„ç´¢å¼•ä½ç½®ã€‚å¦‚æœ `a` ä¸­å·²ç»å­˜åœ¨å…ƒç´  `x`ï¼Œåˆ™è¿”å›åœ¨ç›¸åŒå…ƒç´ å³è¾¹çš„æ’å…¥ä½ç½®ã€‚

**å‚æ•°è¯´æ˜**:
- `a`: æœ‰åºæ•°ç»„
- `x`: è¦æŸ¥æ‰¾æ’å…¥ä½ç½®çš„å…ƒç´ 
- `lo`: æœç´¢èŒƒå›´çš„å·¦è¾¹ç•Œï¼ˆé»˜è®¤ä¸º0ï¼‰
- `hi`: æœç´¢èŒƒå›´çš„å³è¾¹ç•Œï¼ˆé»˜è®¤ä¸ºæ•°ç»„é•¿åº¦ï¼‰

**è¿”å›å€¼**: åº”è¯¥æ’å…¥çš„ä½ç½®ç´¢å¼•

#### bisect_left(a, x, lo=0, hi=len(a))
åŠŸèƒ½ä¸ `bisect_right` ç›¸åŒï¼Œä½†å¦‚æœ `a` ä¸­å·²ç»å­˜åœ¨å…ƒç´  `x`ï¼Œåˆ™è¿”å›åœ¨ç›¸åŒå…ƒç´ å·¦è¾¹çš„æ’å…¥ä½ç½®ã€‚

#### insort_right(a, x, lo=0, hi=len(a))
åœ¨æ•°ç»„ `a` ä¸­æ’å…¥å…ƒç´  `x`ï¼Œå¦‚æœ `x` å·²å­˜åœ¨ï¼Œåˆ™å°† `x` æ’å…¥åœ¨ç›¸åŒå…ƒç´ çš„å³è¾¹ã€‚

**è¿”å›å€¼**: æ— ï¼ˆç›´æ¥ä¿®æ”¹åŸæ•°ç»„ï¼‰

#### insort_left(a, x, lo=0, hi=len(a))
åŠŸèƒ½ä¸ `insort_right` ç›¸åŒï¼Œä½†å¦‚æœ `x` å·²å­˜åœ¨ï¼Œåˆ™å°† `x` æ’å…¥åœ¨ç›¸åŒå…ƒç´ çš„å·¦è¾¹ã€‚

#### insort(a, x, lo=0, hi=len(a))
æ ¹æ®å®éªŒç»“æœï¼Œè¯¥æ–¹æ³•ä¸ `insort_right()` åŠŸèƒ½ç›¸åŒã€‚

#### bisect(a, x, lo=0, hi=len(a))
`bisect_right()` çš„åˆ«åï¼ŒåŠŸèƒ½å®Œå…¨ç›¸åŒã€‚

## ğŸ’¡ å®é™…åº”ç”¨

### è‡ªå®šä¹‰æœ‰åºå®¹å™¨

ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ bisect æ¨¡å—åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„æœ‰åºå®¹å™¨ï¼š

```python
import collections
import bisect

class SortedItems(collections.abc.Sequence):
    """è‡ªå®šä¹‰æœ‰åºå®¹å™¨ç¤ºä¾‹"""
    def __init__(self, initial=None):
        self._items = sorted(initial) if initial is not None else []

    # å¿…éœ€çš„åºåˆ—æ–¹æ³•
    def __getitem__(self, index):
        return self._items[index]

    def __len__(self):
        return len(self._items)

    # åœ¨æ­£ç¡®ä½ç½®æ·»åŠ å…ƒç´ çš„æ–¹æ³•
    def add(self, item):
        bisect.insort(self._items, item)

if __name__ == '__main__':
    items = SortedItems([5, 1, 3])
    print(list(items))  # [1, 3, 5]
    print(items[0])     # 1
    print(items[-1])    # 5
    items.add(2)
    print(list(items))  # [1, 2, 3, 5]
    items.add(-10)
    print(list(items))  # [-10, 1, 2, 3, 5]
    print(items[1:4])   # [1, 2, 3]
    print(3 in items)   # True
    print(len(items))   # 5
    for n in items:
        print(n)        # -10, 1, 2, 3, 5
```

### è¾¹æ’å…¥è¾¹æ’åº

ä½¿ç”¨ bisect å¯ä»¥åœ¨å‘æ•°ç»„æ’å…¥æ•°æ®çš„åŒæ—¶ä¿æŒæ’åºçŠ¶æ€ï¼š

```python
import bisect
import random

random.seed(1)
print('New  pos  contents')
print('--------------------')
l = []

for i in range(1, 15):
    r = random.randint(1, 100)
    position = bisect.bisect(l, r)
    bisect.insort(l, r)
    print(f'{r:3d}  {position:3d}  {l}')
```

è¾“å‡ºç»“æœï¼š
```
New  pos  contents
--------------------
 14    0  [14]
 85    1  [14, 85]
 77    1  [14, 77, 85]
 26    1  [14, 26, 77, 85]
 50    2  [14, 26, 50, 77, 85]
 45    2  [14, 26, 45, 50, 77, 85]
 66    4  [14, 26, 45, 50, 66, 77, 85]
 79    6  [14, 26, 45, 50, 66, 77, 79, 85]
 10    0  [10, 14, 26, 45, 50, 66, 77, 79, 85]
  3    0  [3, 10, 14, 26, 45, 50, 66, 77, 79, 85]
 84    9  [3, 10, 14, 26, 45, 50, 66, 77, 79, 84, 85]
 44    4  [3, 10, 14, 26, 44, 45, 50, 66, 77, 79, 84, 85]
 77    9  [3, 10, 14, 26, 44, 45, 50, 66, 77, 77, 79, 84, 85]
  1    0  [1, 3, 10, 14, 26, 44, 45, 50, 66, 77, 77, 79, 84, 85]
```

### å·¦æ’å…¥ä¸å³æ’å…¥çš„åŒºåˆ«

å½“æ•°ç»„ä¸­å­˜åœ¨é‡å¤å…ƒç´ æ—¶ï¼Œå·¦æ’å…¥å’Œå³æ’å…¥ä¼šæœ‰ä¸åŒçš„è¡Œä¸ºï¼š

```python
import bisect
import random

random.seed(1)
print('New  pos  contents (left insertion)')
print('-------------------------------------')
l = []

for i in range(1, 15):
    r = random.randint(1, 100)
    position = bisect.bisect_left(l, r)
    bisect.insort_left(l, r)
    print(f'{r:3d}  {position:3d}  {l}')
```

åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œå½“æ’å…¥é‡å¤å…ƒç´ 77æ—¶ï¼Œä½¿ç”¨å·¦æ’å…¥çš„ä½ç½®ç´¢å¼•æ˜¯8ï¼Œè€Œä½¿ç”¨å³æ’å…¥çš„ä½ç½®ç´¢å¼•æ˜¯9ã€‚

### è‡ªå®šä¹‰äºŒåˆ†æŸ¥æ‰¾å®ç°

#### éé€’å½’å®ç°

```python
def binary_search(alist, elem):
    """éé€’å½’äºŒåˆ†æŸ¥æ‰¾"""
    start = 0
    end = len(alist) - 1
    while start <= end:
        mid = (end + start) // 2
        if elem == alist[mid]:
            return mid
        elif elem < alist[mid]:
            end = mid - 1
        else:
            start = mid + 1
    return None

# æµ‹è¯•
testlist = [0, 1, 2, 8, 13, 17, 19, 32, 42]
result = binary_search(testlist, 42)
print(f"å…ƒç´ 42çš„ç´¢å¼•: {result}")  # è¾“å‡º: 8
```

#### é€’å½’å®ç°

```python
def binary_search_recursive(alist, elem):
    """é€’å½’äºŒåˆ†æŸ¥æ‰¾"""
    if len(alist) == 0:
        return False
    
    mid = len(alist) // 2
    guess = alist[mid]
    
    if elem == guess:
        return True
    elif elem < guess:
        return binary_search_recursive(alist[:mid], elem)
    else:
        return binary_search_recursive(alist[mid+1:], elem)

# æµ‹è¯•
testlist = [0, 1, 2, 8, 13, 17, 19, 32, 42]
result = binary_search_recursive(testlist, 42)
print(f"å…ƒç´ 42æ˜¯å¦å­˜åœ¨: {result}")  # è¾“å‡º: True
```

#### æ ‡å‡†é€’å½’å®ç°ï¼ˆè¿”å›ç´¢å¼•ï¼‰

```python
def binary_search_index(arr, l, r, x):
    """è¿”å› x åœ¨ arr ä¸­çš„ç´¢å¼•ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å› -1"""
    
    # åŸºæœ¬åˆ¤æ–­
    if r >= l:
        mid = int(l + (r - l) / 2)
        
        # å…ƒç´ æ­£å¥½åœ¨ä¸­é—´ä½ç½®
        if arr[mid] == x:
            return mid
        
        # å…ƒç´ å°äºä¸­é—´ä½ç½®çš„å…ƒç´ ï¼Œåªéœ€è¦å†æ¯”è¾ƒå·¦è¾¹çš„å…ƒç´ 
        elif arr[mid] > x:
            return binary_search_index(arr, l, mid - 1, x)
        
        # å…ƒç´ å¤§äºä¸­é—´ä½ç½®çš„å…ƒç´ ï¼Œåªéœ€è¦å†æ¯”è¾ƒå³è¾¹çš„å…ƒç´ 
        else:
            return binary_search_index(arr, mid + 1, r, x)
    else:
        # ä¸å­˜åœ¨
        return -1

# æµ‹è¯•æ•°ç»„
arr = [2, 3, 4, 10, 40]
x = 10

# å‡½æ•°è°ƒç”¨
result = binary_search_index(arr, 0, len(arr) - 1, x)

if result != -1:
    print(f"å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•ä¸º {result}")
else:
    print("å…ƒç´ ä¸åœ¨æ•°ç»„ä¸­")
```

### é«˜çº§åº”ç”¨

bisect æ¨¡å—çš„ `bisect.bisect(list, key)` å‡½æ•°ç±»ä¼¼äº Java ä¸­ TreeMap çš„ `tailMap(fromkey)` æ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¿«é€Ÿå®šä½æœ‰åºæ•°æ®ç»“æ„ä¸­çš„ä½ç½®ã€‚

```python
import bisect

# æˆç»©æ’åºåº”ç”¨ç¤ºä¾‹
grades = [60, 70, 80, 85, 90, 95]
new_grade = 88

# æ‰¾åˆ°æ–°æˆç»©åº”è¯¥æ’å…¥çš„ä½ç½®
position = bisect.bisect_left(grades, new_grade)
print(f"æˆç»© {new_grade} åº”è¯¥æ’å…¥åˆ°ä½ç½® {position}")

# æ’å…¥æ–°æˆç»©å¹¶ä¿æŒæ’åº
bisect.insort(grades, new_grade)
print(f"æ’å…¥åçš„æˆç»©åˆ—è¡¨: {grades}")
```

## âš ï¸ æ³¨æ„äº‹é¡¹

- bisect æ¨¡å—çš„æ‰€æœ‰å‡½æ•°éƒ½å‡è®¾è¾“å…¥æ•°ç»„æ˜¯å‡åºæ’åºçš„
- å¯¹äºé‡å¤å…ƒç´ ï¼Œè¦æ ¹æ®éœ€æ±‚é€‰æ‹©ä½¿ç”¨ left è¿˜æ˜¯ right ç‰ˆæœ¬çš„å‡½æ•°
- bisect æ¨¡å—ä¸»è¦ç”¨äºç»´æŠ¤å·²æ’åºçš„æ•°ç»„ï¼Œä¸é€‚ç”¨äºæ’åºæ“ä½œæœ¬èº«
- æ—¶é—´å¤æ‚åº¦ä¸º O(log n)ï¼Œæ¯”çº¿æ€§æœç´¢ O(n) æ›´é«˜æ•ˆ
- æ’å…¥æ“ä½œçš„æ€»æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œå› ä¸ºéœ€è¦ç§»åŠ¨å…ƒç´ 

## ğŸ”— ç›¸å…³å†…å®¹

- [heapq æ¨¡å— - å †é˜Ÿåˆ—ç®—æ³•](../heapq/)
- [sorted() å‡½æ•° - æ’åºæ“ä½œ](../../builtins/sorted/)
- [collections æ¨¡å— - é«˜çº§å®¹å™¨æ•°æ®ç±»å‹](../collections/)

## ğŸ“š æ‰©å±•é˜…è¯»

- [Python å®˜æ–¹æ–‡æ¡£ - bisect æ¨¡å—](https://docs.python.org/3/library/bisect.html)
- [äºŒåˆ†æŸ¥æ‰¾ç®—æ³•è¯¦è§£](https://blog.csdn.net/qq_45978890/article/details/116094046)
- [ç®—æ³•å¯¼è®º - äºŒåˆ†æœç´¢](https://mitpress.mit.edu/books/introduction-algorithms)

## ğŸ·ï¸ æ ‡ç­¾

`bisect` `äºŒåˆ†æŸ¥æ‰¾` `æœ‰åºæ•°ç»„` `æ’åº` `æ’å…¥`

---

**æœ€åæ›´æ–°**: 2024-01-15  
**ä½œè€…**: Python æ–‡æ¡£å›¢é˜Ÿ  
**ç‰ˆæœ¬**: 1.0