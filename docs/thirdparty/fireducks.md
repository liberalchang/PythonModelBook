---
title: "FireDucks - Pandasæ€§èƒ½åŠ é€Ÿåº“"
author: "PythonæŠ€æœ¯æ–‡æ¡£å·¥ç¨‹å¸ˆ"
date: "2024-01-15"
version: "1.0.0"
python_version: "3.8+"
library_version: "fireducks>=0.1.0, pandas>=1.3.0"
tags: ["fireducks", "pandas", "æ€§èƒ½ä¼˜åŒ–", "åŠ é€Ÿ", "æ•°æ®å¤„ç†"]
difficulty: "ä¸­çº§"
estimated_time: "25åˆ†é’Ÿ"
---

# FireDucks - Pandasæ€§èƒ½åŠ é€Ÿåº“

## ğŸ“‹ æ¦‚è¿°

FireDucksæ˜¯ç”±NEC Laboratorieså¼€å‘çš„ä¸€ä¸ªé«˜æ€§èƒ½Pandasæ›¿ä»£åº“ï¼Œèƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹ç°æœ‰ä»£ç çš„æƒ…å†µä¸‹æ˜¾è‘—æå‡Pandasçš„å¤„ç†é€Ÿåº¦ã€‚è¯¥åº“é€šè¿‡ä¼˜åŒ–åº•å±‚å®ç°ï¼Œåœ¨CPUç¯å¢ƒä¸‹ä¹Ÿèƒ½å®ç°æ•°å€çš„æ€§èƒ½æå‡ï¼Œç‰¹åˆ«é€‚åˆå¤„ç†å¤§é‡æ•°æ®çš„åœºæ™¯ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

é€šè¿‡æœ¬æ–‡æ¡£çš„å­¦ä¹ ï¼Œæ‚¨å°†èƒ½å¤Ÿï¼š

- äº†è§£FireDucksçš„å·¥ä½œåŸç†å’Œä¼˜åŠ¿
- æŒæ¡FireDucksçš„å®‰è£…å’Œé…ç½®æ–¹æ³•
- å­¦ä¼šä¸¤ç§ä½¿ç”¨æ–¹å¼ï¼šéšå¼å¯¼å…¥å’Œæ˜¾å¼å¯¼å…¥
- ç†è§£FireDucksçš„æ€§èƒ½ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯
- æŒæ¡æ€§èƒ½æµ‹è¯•å’Œå¯¹æ¯”æ–¹æ³•

## ğŸ“š å‰ç½®çŸ¥è¯†

- PandasåŸºç¡€æ“ä½œ
- PythonåŒ…ç®¡ç†
- åŸºæœ¬çš„æ€§èƒ½æµ‹è¯•æ¦‚å¿µ

## ğŸ“– è¯¦ç»†å†…å®¹

### åŸºæœ¬æ¦‚å¿µ

#### ä»€ä¹ˆæ˜¯FireDucks

FireDucksæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„Pandaså…¼å®¹åº“ï¼Œä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ï¼š

- **æ— ç¼æ›¿æ¢**ï¼šæ— éœ€ä¿®æ”¹ç°æœ‰Pandasä»£ç 
- **æ€§èƒ½æå‡**ï¼šåœ¨CPUç¯å¢ƒä¸‹å®ç°æ•°å€æ€§èƒ½æå‡
- **å…¼å®¹æ€§å¥½**ï¼šæ”¯æŒå¤§éƒ¨åˆ†Pandas API
- **å…è´¹ä½¿ç”¨**ï¼šBetaç‰ˆæœ¬å¯å…è´¹ä½¿ç”¨
- **æ¸è¿›å¼æ”¯æŒ**ï¼šä¸æ”¯æŒçš„æ–¹æ³•ä¼šè‡ªåŠ¨å›é€€åˆ°åŸç”ŸPandas

#### å·¥ä½œåŸç†

FireDucksé€šè¿‡ä»¥ä¸‹æ–¹å¼å®ç°æ€§èƒ½æå‡ï¼š

1. **ä¼˜åŒ–çš„åº•å±‚å®ç°**ï¼šé‡æ–°å®ç°äº†æ ¸å¿ƒæ•°æ®ç»“æ„å’Œç®—æ³•
2. **å¹¶è¡Œè®¡ç®—**ï¼šå……åˆ†åˆ©ç”¨å¤šæ ¸CPUèµ„æº
3. **å†…å­˜ä¼˜åŒ–**ï¼šå‡å°‘å†…å­˜åˆ†é…å’Œå¤åˆ¶æ“ä½œ
4. **å»¶è¿Ÿè®¡ç®—**ï¼šä¼˜åŒ–è®¡ç®—å›¾æ‰§è¡Œé¡ºåº

### å®‰è£…å’Œé…ç½®

#### å®‰è£…FireDucks

```bash
# ä½¿ç”¨pipå®‰è£…
pip install fireducks

# åœ¨Jupyter Notebookä¸­å®‰è£…
!pip install fireducks
```

#### éªŒè¯å®‰è£…

```python
# éªŒè¯FireDucksæ˜¯å¦æ­£ç¡®å®‰è£…
try:
    import fireducks.pandas as pd
    print("FireDuckså®‰è£…æˆåŠŸï¼")
    print(f"FireDucksç‰ˆæœ¬: {pd.__version__}")
except ImportError as e:
    print(f"FireDuckså®‰è£…å¤±è´¥: {e}")
```

### ä½¿ç”¨æ–¹æ³•

#### æ–¹æ³•ä¸€ï¼šéšå¼å¯¼å…¥ï¼ˆImport Hookï¼‰

è¿™ç§æ–¹æ³•æ— éœ€ä¿®æ”¹ä»»ä½•ä»£ç ï¼Œé€šè¿‡å¯åŠ¨å‚æ•°è‡ªåŠ¨æ›¿æ¢Pandasã€‚

```bash
# åœ¨å‘½ä»¤è¡Œä¸­ä½¿ç”¨
python -m fireducks.imhook your_script.py

# ç¤ºä¾‹ï¼šè¿è¡ŒåŒ…å«Pandasä»£ç çš„è„šæœ¬
python -m fireducks.imhook data_analysis.py
```

**ä¼˜ç‚¹**ï¼š
- æ— éœ€ä¿®æ”¹ç°æœ‰ä»£ç 
- é€‚åˆå¿«é€Ÿæµ‹è¯•æ€§èƒ½æå‡
- å¯ä»¥ç›´æ¥åœ¨ç°æœ‰é¡¹ç›®ä¸­ä½¿ç”¨

**ç¼ºç‚¹**ï¼š
- éœ€è¦ä¿®æ”¹å¯åŠ¨æ–¹å¼
- è°ƒè¯•æ—¶å¯èƒ½ä¸å¤Ÿç›´è§‚

#### æ–¹æ³•äºŒï¼šæ˜¾å¼å¯¼å…¥

ç›´æ¥åœ¨ä»£ç ä¸­å¯¼å…¥FireDucksæ›¿ä»£Pandasã€‚

```python
# åŸå§‹Pandaså¯¼å…¥
# import pandas as pd

# ä½¿ç”¨FireDucksæ›¿ä»£
import fireducks.pandas as pd
import numpy as np

# å…¶ä½™ä»£ç ä¿æŒä¸å˜
df = pd.DataFrame({'A': [1, 2, 3], 'B': [4, 5, 6]})
print(df.head())
```

**ä¼˜ç‚¹**ï¼š
- ä»£ç æ›´åŠ æ˜ç¡®
- ä¾¿äºè°ƒè¯•å’Œç»´æŠ¤
- å¯ä»¥é€‰æ‹©æ€§åœ°åœ¨éƒ¨åˆ†æ¨¡å—ä¸­ä½¿ç”¨

**ç¼ºç‚¹**ï¼š
- éœ€è¦ä¿®æ”¹å¯¼å…¥è¯­å¥
- åœ¨å¤§å‹é¡¹ç›®ä¸­å¯èƒ½éœ€è¦å¤šå¤„ä¿®æ”¹

### æ€§èƒ½æµ‹è¯•å’Œå¯¹æ¯”

#### åŸºç¡€æ€§èƒ½æµ‹è¯•

```python
import time
import numpy as np

# å‡†å¤‡æµ‹è¯•æ•°æ®
url = 'https://raw.githubusercontent.com/pandas-dev/pandas/master/doc/data/titanic.csv'

# æµ‹è¯•åŸç”ŸPandasæ€§èƒ½
import pandas as pd_original

print("æµ‹è¯•åŸç”ŸPandasæ€§èƒ½...")
titanic_original = pd_original.read_csv(url)

start_time = time.time()
for i in range(10000):
    result = titanic_original.groupby(["Sex", "Pclass"])["Fare"].mean()
original_time = time.time() - start_time

print(f"åŸç”ŸPandasè€—æ—¶: {original_time:.2f}ç§’")

# æµ‹è¯•FireDucksæ€§èƒ½
import fireducks.pandas as pd_fire

print("\næµ‹è¯•FireDucksæ€§èƒ½...")
titanic_fire = pd_fire.read_csv(url)

start_time = time.time()
for i in range(10000):
    result = titanic_fire.groupby(["Sex", "Pclass"])["Fare"].mean()
fire_time = time.time() - start_time

print(f"FireDucksè€—æ—¶: {fire_time:.2f}ç§’")
print(f"æ€§èƒ½æå‡: {original_time / fire_time:.2f}å€")
```

#### å¤æ‚æ“ä½œæ€§èƒ½æµ‹è¯•

```python
def performance_test(pd_module, data_size=100000, iterations=100):
    """æ€§èƒ½æµ‹è¯•å‡½æ•°"""
    # ç”Ÿæˆæµ‹è¯•æ•°æ®
    np.random.seed(42)
    data = {
        'A': np.random.randn(data_size),
        'B': np.random.randint(0, 100, data_size),
        'C': np.random.choice(['X', 'Y', 'Z'], data_size),
        'D': np.random.randn(data_size)
    }
    df = pd_module.DataFrame(data)
    
    # æµ‹è¯•å„ç§æ“ä½œ
    operations = {
        'groupby_mean': lambda: df.groupby('C')['A'].mean(),
        'sort_values': lambda: df.sort_values('A'),
        'merge_self': lambda: pd_module.merge(df.head(1000), df.tail(1000), on='B', how='inner'),
        'pivot_table': lambda: df.pivot_table(values='A', index='C', columns='B', aggfunc='mean'),
        'rolling_mean': lambda: df['A'].rolling(window=10).mean()
    }
    
    results = {}
    for op_name, operation in operations.items():
        start_time = time.time()
        for _ in range(iterations):
            try:
                result = operation()
            except Exception as e:
                print(f"æ“ä½œ {op_name} å¤±è´¥: {e}")
                results[op_name] = float('inf')
                break
        else:
            results[op_name] = time.time() - start_time
    
    return results

# è¿è¡Œæ€§èƒ½å¯¹æ¯”æµ‹è¯•
print("è¿è¡Œç»¼åˆæ€§èƒ½æµ‹è¯•...")

# æµ‹è¯•åŸç”ŸPandas
import pandas as pd_original
original_results = performance_test(pd_original)

# æµ‹è¯•FireDucks
import fireducks.pandas as pd_fire
fire_results = performance_test(pd_fire)

# è¾“å‡ºç»“æœ
print("\næ€§èƒ½å¯¹æ¯”ç»“æœ:")
print(f"{'æ“ä½œ':<15} {'åŸç”ŸPandas':<12} {'FireDucks':<12} {'æå‡å€æ•°':<10}")
print("-" * 55)

for op_name in original_results:
    original_time = original_results[op_name]
    fire_time = fire_results[op_name]
    
    if fire_time != float('inf') and fire_time > 0:
        speedup = original_time / fire_time
        print(f"{op_name:<15} {original_time:<12.3f} {fire_time:<12.3f} {speedup:<10.2f}")
    else:
        print(f"{op_name:<15} {original_time:<12.3f} {'å¤±è´¥':<12} {'N/A':<10}")
```

### å…¼å®¹æ€§å’Œé™åˆ¶

#### æ”¯æŒçš„æ“ä½œ

FireDucksæ”¯æŒå¤§éƒ¨åˆ†å¸¸ç”¨çš„Pandasæ“ä½œï¼š

```python
import fireducks.pandas as pd
import numpy as np

# æ”¯æŒçš„åŸºæœ¬æ“ä½œ
df = pd.DataFrame({
    'A': [1, 2, 3, 4, 5],
    'B': [10, 20, 30, 40, 50],
    'C': ['a', 'b', 'c', 'd', 'e']
})

# æ•°æ®é€‰æ‹©å’Œè¿‡æ»¤
print("æ•°æ®é€‰æ‹©:", df[df['A'] > 2])

# åˆ†ç»„èšåˆ
print("åˆ†ç»„èšåˆ:", df.groupby('C')['A'].sum())

# æ’åº
print("æ’åº:", df.sort_values('B'))

# ç»Ÿè®¡æ“ä½œ
print("ç»Ÿè®¡:", df.describe())
```

#### ä¸æ”¯æŒçš„æ“ä½œå¤„ç†

```python
# FireDucksä¼šè‡ªåŠ¨å›é€€åˆ°åŸç”ŸPandaså¤„ç†ä¸æ”¯æŒçš„æ“ä½œ
def test_compatibility():
    """æµ‹è¯•å…¼å®¹æ€§"""
    import fireducks.pandas as pd
    
    df = pd.DataFrame({
        'A': [1, 2, 3],
        'B': [4, 5, 6]
    })
    
    try:
        # å°è¯•ä¸€äº›å¯èƒ½ä¸è¢«æ”¯æŒçš„æ“ä½œ
        result1 = df.rolling(window=2).mean()  # æ»šåŠ¨çª—å£
        print("æ»šåŠ¨çª—å£æ“ä½œæˆåŠŸ")
        
        result2 = df.resample('D').mean()  # é‡é‡‡æ ·ï¼ˆéœ€è¦æ—¶é—´ç´¢å¼•ï¼‰
        print("é‡é‡‡æ ·æ“ä½œæˆåŠŸ")
        
    except Exception as e:
        print(f"æŸäº›æ“ä½œå¯èƒ½ä¸è¢«æ”¯æŒ: {e}")
        print("FireDucksä¼šè‡ªåŠ¨å›é€€åˆ°åŸç”ŸPandas")

test_compatibility()
```

## ğŸ’¡ å®é™…åº”ç”¨

### åŸºç¡€ç”¨æ³•ç¤ºä¾‹

```python
# å¤§æ•°æ®é›†å¤„ç†ç¤ºä¾‹
import fireducks.pandas as pd
import numpy as np
import time

# ç”Ÿæˆå¤§å‹æ•°æ®é›†
print("ç”Ÿæˆå¤§å‹æ•°æ®é›†...")
n_rows = 1000000
data = {
    'user_id': np.random.randint(1, 10000, n_rows),
    'product_id': np.random.randint(1, 1000, n_rows),
    'quantity': np.random.randint(1, 10, n_rows),
    'price': np.random.uniform(10, 1000, n_rows),
    'timestamp': pd.date_range('2023-01-01', periods=n_rows, freq='1min')
}

df = pd.DataFrame(data)
print(f"æ•°æ®é›†å¤§å°: {len(df):,} è¡Œ")

# å¤æ‚æ•°æ®åˆ†æ
print("\næ‰§è¡Œå¤æ‚æ•°æ®åˆ†æ...")
start_time = time.time()

# è®¡ç®—é”€å”®é¢
df['total_amount'] = df['quantity'] * df['price']

# ç”¨æˆ·çº§åˆ«èšåˆ
user_stats = df.groupby('user_id').agg({
    'total_amount': ['sum', 'mean', 'count'],
    'quantity': 'sum'
}).round(2)

# äº§å“çº§åˆ«èšåˆ
product_stats = df.groupby('product_id').agg({
    'total_amount': 'sum',
    'quantity': 'sum'
}).sort_values('total_amount', ascending=False)

# æ—¶é—´åºåˆ—åˆ†æ
daily_sales = df.groupby(df['timestamp'].dt.date)['total_amount'].sum()

processing_time = time.time() - start_time
print(f"å¤„ç†å®Œæˆï¼Œè€—æ—¶: {processing_time:.2f}ç§’")
print(f"ç”¨æˆ·ç»Ÿè®¡å‰5è¡Œ:\n{user_stats.head()}")
print(f"\nçƒ­é—¨äº§å“å‰5å:\n{product_stats.head()}")
```

### é«˜çº§ç”¨æ³•ç¤ºä¾‹

```python
# æ€§èƒ½ç›‘æ§å’Œå¯¹æ¯”å·¥å…·
class PerformanceMonitor:
    """æ€§èƒ½ç›‘æ§å·¥å…·"""
    
    def __init__(self):
        self.results = {}
    
    def time_operation(self, name, operation, *args, **kwargs):
        """è®¡æ—¶æ“ä½œ"""
        start_time = time.time()
        result = operation(*args, **kwargs)
        end_time = time.time()
        
        self.results[name] = end_time - start_time
        return result
    
    def compare_libraries(self, operation_func, data, libraries):
        """å¯¹æ¯”ä¸åŒåº“çš„æ€§èƒ½"""
        comparison_results = {}
        
        for lib_name, lib_module in libraries.items():
            print(f"æµ‹è¯• {lib_name}...")
            try:
                start_time = time.time()
                result = operation_func(lib_module, data)
                end_time = time.time()
                comparison_results[lib_name] = end_time - start_time
            except Exception as e:
                print(f"{lib_name} æ‰§è¡Œå¤±è´¥: {e}")
                comparison_results[lib_name] = None
        
        return comparison_results
    
    def print_comparison(self, results):
        """æ‰“å°å¯¹æ¯”ç»“æœ"""
        print("\næ€§èƒ½å¯¹æ¯”ç»“æœ:")
        print("-" * 40)
        
        valid_results = {k: v for k, v in results.items() if v is not None}
        if not valid_results:
            print("æ²¡æœ‰æœ‰æ•ˆçš„æµ‹è¯•ç»“æœ")
            return
        
        fastest_time = min(valid_results.values())
        
        for lib_name, exec_time in valid_results.items():
            speedup = fastest_time / exec_time if exec_time > 0 else 0
            print(f"{lib_name:<15}: {exec_time:.3f}s (ç›¸å¯¹æœ€å¿«: {speedup:.2f}x)")

# ä½¿ç”¨ç¤ºä¾‹
def complex_analysis(pd_module, data):
    """å¤æ‚æ•°æ®åˆ†æå‡½æ•°"""
    df = pd_module.DataFrame(data)
    
    # å¤šæ­¥éª¤åˆ†æ
    result1 = df.groupby('category')['value'].agg(['mean', 'std', 'count'])
    result2 = df.pivot_table(values='value', index='category', columns='type', aggfunc='sum')
    result3 = df.sort_values('value').tail(100)
    
    return result1, result2, result3

# å‡†å¤‡æµ‹è¯•æ•°æ®
test_data = {
    'category': np.random.choice(['A', 'B', 'C', 'D'], 50000),
    'type': np.random.choice(['X', 'Y', 'Z'], 50000),
    'value': np.random.randn(50000)
}

# æ€§èƒ½å¯¹æ¯”
monitor = PerformanceMonitor()

libraries = {
    'Pandas': __import__('pandas'),
    'FireDucks': __import__('fireducks.pandas')
}

comparison = monitor.compare_libraries(complex_analysis, test_data, libraries)
monitor.print_comparison(comparison)
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **Betaç‰ˆæœ¬**ï¼šFireDucksç›®å‰å¤„äºBetaé˜¶æ®µï¼Œå¯èƒ½å­˜åœ¨ç¨³å®šæ€§é—®é¢˜
2. **APIå…¼å®¹æ€§**ï¼šå¹¶éæ‰€æœ‰Pandas APIéƒ½è¢«æ”¯æŒï¼Œä¸æ”¯æŒçš„ä¼šå›é€€åˆ°åŸç”ŸPandas
3. **å†…å­˜ä½¿ç”¨**ï¼šæŸäº›æ“ä½œå¯èƒ½ä½¿ç”¨æ›´å¤šå†…å­˜æ¥æ¢å–é€Ÿåº¦æå‡
4. **è°ƒè¯•å›°éš¾**ï¼šä½¿ç”¨éšå¼å¯¼å…¥æ—¶ï¼Œè°ƒè¯•å¯èƒ½æ¯”è¾ƒå›°éš¾
5. **ä¾èµ–ç®¡ç†**ï¼šç¡®ä¿FireDucksç‰ˆæœ¬ä¸Pandasç‰ˆæœ¬å…¼å®¹
6. **ç”Ÿäº§ç¯å¢ƒ**ï¼šåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰éœ€è¦å……åˆ†æµ‹è¯•

## ğŸ”— ç›¸å…³å†…å®¹

- [Pandas åŸºç¡€æ“ä½œ](pandas-basics.md)
- [Pandas æ•°æ®è¯»å†™](pandas-io.md)
- [Pandas é«˜çº§åŠŸèƒ½](pandas-advanced.md)
- [æ€§èƒ½ä¼˜åŒ–æœ€ä½³å®è·µ](performance-optimization.md)

## ğŸ“š æ‰©å±•é˜…è¯»

- [FireDuckså®˜æ–¹ç½‘ç«™](https://fireducks-dev.github.io/)
- [NEC Laboratoriesç ”ç©¶è®ºæ–‡](https://www.nec.com/en/global/rd/)
- [Pandasæ€§èƒ½ä¼˜åŒ–æŒ‡å—](https://pandas.pydata.org/docs/user_guide/enhancingperf.html)
- [Pythonæ•°æ®å¤„ç†æ€§èƒ½å¯¹æ¯”](https://github.com/h2oai/db-benchmark)

## ğŸ·ï¸ æ ‡ç­¾

`fireducks` `pandas` `æ€§èƒ½ä¼˜åŒ–` `åŠ é€Ÿ` `æ•°æ®å¤„ç†` `NEC` `é«˜æ€§èƒ½è®¡ç®—` `CPUä¼˜åŒ–`