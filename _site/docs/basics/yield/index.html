<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>yield关键字 - Python知识体系文档</title>
  <meta name="description" content="系统化整理Python知识体系的开源项目">

  <!-- SEO标签 -->
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>yield关键字 | Python知识体系文档</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="yield关键字" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="系统化整理Python知识体系的开源项目" />
<meta property="og:description" content="系统化整理Python知识体系的开源项目" />
<link rel="canonical" href="http://0.0.0.0:4000/PythonModelBook/docs/basics/yield/" />
<meta property="og:url" content="http://0.0.0.0:4000/PythonModelBook/docs/basics/yield/" />
<meta property="og:site_name" content="Python知识体系文档" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="yield关键字" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"系统化整理Python知识体系的开源项目","headline":"yield关键字","url":"http://0.0.0.0:4000/PythonModelBook/docs/basics/yield/"}</script>
<!-- End Jekyll SEO tag -->


  <!-- 样式文件 -->
  <link rel="stylesheet" href="/PythonModelBook/assets/css/main.css">
  <link rel="stylesheet" href="/PythonModelBook/assets/css/light-theme.css">
  <link rel="stylesheet" href="/PythonModelBook/assets/css/dark-theme.css">

  <!-- 字体 -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- 图标 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <!-- 搜索功能 -->
  <script src="https://unpkg.com/lunr/lunr.js"></script>
</head>

<body>
  <!-- 导航栏 -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-brand">
        <a href="/PythonModelBook/" class="brand-link">
          <i class="fab fa-python"></i>
          <span>Python知识体系文档</span>
        </a>
      </div>

      <!-- 搜索框 -->
      <div class="nav-search">
        <div class="search-container">
          <input type="text" id="search-input" placeholder="搜索文档..." class="search-input">
          <i class="fas fa-search search-icon"></i>
          <div id="search-results" class="search-results"></div>
        </div>
      </div>

      <!-- 导航菜单 -->
      <div class="nav-menu">
        <a href="/PythonModelBook/" class="nav-link">首页</a>
        <a href="/PythonModelBook/docs/" class="nav-link">文档</a>
        <a href="/PythonModelBook/about/" class="nav-link">关于</a>
        <button id="theme-toggle" class="theme-toggle" title="切换主题">
          <i class="fas fa-moon"></i>
        </button>
      </div>

      <!-- 移动端菜单按钮 -->
      <button class="mobile-menu-btn" id="mobile-menu-btn">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>

  <!-- 主要内容 -->
  <main class="main-content">
    <div class="doc-container">
  <!-- 文档内容区域 -->
  <main class="doc-content">
    <article class="doc-article">
      <!-- 文档头部信息 -->
      <header class="doc-header">
        <h1 class="doc-title">yield关键字</h1>
        
        
        
        <div class="doc-meta">
          
          
          
          
          
        </div>
        
        
      </header>
      
      <!-- 文档正文 -->
      <div class="doc-body">
        <h1 id="yield关键字">yield关键字</h1>

<h2 id="概述">概述</h2>

<p><code class="language-plaintext highlighter-rouge">yield</code> 是 Python 中用于创建生成器（Generator）的关键字。与 <code class="language-plaintext highlighter-rouge">return</code> 不同，<code class="language-plaintext highlighter-rouge">yield</code> 会暂停函数的执行并返回一个值，当再次调用时会从暂停的地方继续执行。这种机制使得生成器能够按需产生数据，实现内存高效的迭代。</p>

<h2 id="学习目标">学习目标</h2>

<p>通过本章学习，你将掌握：</p>
<ul>
  <li>yield 关键字的基本语法和工作原理</li>
  <li>生成器函数的创建和使用</li>
  <li>生成器表达式的语法</li>
  <li>yield from 语句的使用</li>
  <li>协程的基本概念和应用</li>
  <li>生成器在实际项目中的应用场景</li>
</ul>

<h2 id="前置知识">前置知识</h2>

<ul>
  <li>Python 基础语法</li>
  <li>函数的定义和调用</li>
  <li>迭代器和可迭代对象的概念</li>
  <li>异常处理机制</li>
</ul>

<h2 id="详细内容">详细内容</h2>

<h3 id="yield-基本语法">yield 基本语法</h3>

<h4 id="简单生成器">简单生成器</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">simple_generator</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">开始执行</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">yield</span> <span class="mi">1</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">第一次暂停后继续</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">yield</span> <span class="mi">2</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">第二次暂停后继续</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">yield</span> <span class="mi">3</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器结束</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 创建生成器对象
</span><span class="n">gen</span> <span class="o">=</span> <span class="nf">simple_generator</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">生成器对象: </span><span class="si">{</span><span class="n">gen</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 逐步获取值
</span><span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第一个值: </span><span class="si">{</span><span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第二个值: </span><span class="si">{</span><span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第三个值: </span><span class="si">{</span><span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 尝试获取下一个值会引发 StopIteration
</span><span class="k">try</span><span class="p">:</span>
    <span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器已耗尽</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="带参数的生成器">带参数的生成器</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">countdown</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">倒计时生成器</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">开始倒计时从 </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">n</span>
        <span class="n">n</span> <span class="o">-=</span> <span class="mi">1</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">倒计时结束</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 使用生成器
</span><span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">countdown</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">倒计时: </span><span class="si">{</span><span class="n">num</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">使用列表推导式对比:</span><span class="sh">"</span><span class="p">)</span>
<span class="c1"># 生成器表达式
</span><span class="n">gen_expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">生成器表达式: </span><span class="si">{</span><span class="n">gen_expr</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">生成器内容: </span><span class="si">{</span><span class="nf">list</span><span class="p">(</span><span class="n">gen_expr</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="无限生成器">无限生成器</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fibonacci</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">斐波那契数列生成器</span><span class="sh">"""</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">a</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="k">def</span> <span class="nf">prime_numbers</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">质数生成器</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nf">int</span><span class="p">(</span><span class="n">n</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>
    
    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">is_prime</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">n</span>
        <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># 使用无限生成器
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">前10个斐波那契数:</span><span class="sh">"</span><span class="p">)</span>
<span class="n">fib_gen</span> <span class="o">=</span> <span class="nf">fibonacci</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">fib_gen</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">前10个质数:</span><span class="sh">"</span><span class="p">)</span>
<span class="n">prime_gen</span> <span class="o">=</span> <span class="nf">prime_numbers</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">prime</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">prime_gen</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">prime</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="sh">"</span><span class="s"> </span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="生成器的高级特性">生成器的高级特性</h3>

<h4 id="send-方法">send() 方法</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">interactive_generator</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">可以接收外部输入的生成器</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器启动</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span> <span class="sh">"</span><span class="s">请发送一个值</span><span class="sh">"</span>
    
    <span class="k">while</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">收到值: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">处理字符串: </span><span class="si">{</span><span class="n">value</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span><span class="si">}</span><span class="sh">"</span>
        <span class="k">elif</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">response</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">处理数字: </span><span class="si">{</span><span class="n">value</span> <span class="o">*</span> <span class="mi">2</span><span class="si">}</span><span class="sh">"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">处理其他类型: </span><span class="si">{</span><span class="nf">type</span><span class="p">(</span><span class="n">value</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="sh">"</span>
        
        <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">response</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器结束</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 使用 send() 方法
</span><span class="n">gen</span> <span class="o">=</span> <span class="nf">interactive_generator</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">))</span>  <span class="c1"># 启动生成器
</span>
<span class="nf">print</span><span class="p">(</span><span class="n">gen</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="sh">"</span><span class="s">hello</span><span class="sh">"</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">gen</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">gen</span><span class="p">.</span><span class="nf">send</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>

<span class="c1"># 结束生成器
</span><span class="k">try</span><span class="p">:</span>
    <span class="n">gen</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器已结束</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="throw-和-close-方法">throw() 和 close() 方法</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">robust_generator</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">具有异常处理的生成器</span><span class="sh">"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器开始</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">yield</span> <span class="mi">1</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">继续执行</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">yield</span> <span class="mi">2</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">即将结束</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">yield</span> <span class="mi">3</span>
        
    <span class="k">except</span> <span class="nb">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">捕获到 ValueError: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">yield</span> <span class="sa">f</span><span class="sh">"</span><span class="s">错误处理: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span>
    
    <span class="k">except</span> <span class="nb">GeneratorExit</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器被关闭</span><span class="sh">"</span><span class="p">)</span>
        <span class="c1"># 不能在 GeneratorExit 处理中使用 yield
</span>    
    <span class="k">finally</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器清理</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 测试异常处理
</span><span class="n">gen</span> <span class="o">=</span> <span class="nf">robust_generator</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第一个值: </span><span class="si">{</span><span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 向生成器抛出异常
</span><span class="k">try</span><span class="p">:</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">gen</span><span class="p">.</span><span class="nf">throw</span><span class="p">(</span><span class="nb">ValueError</span><span class="p">,</span> <span class="sh">"</span><span class="s">测试异常</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">异常处理结果: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器在异常处理后结束</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 测试关闭生成器
</span><span class="n">gen2</span> <span class="o">=</span> <span class="nf">robust_generator</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">第一个值: </span><span class="si">{</span><span class="nf">next</span><span class="p">(</span><span class="n">gen2</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="n">gen2</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>  <span class="c1"># 关闭生成器
</span></code></pre></div></div>

<h3 id="yield-from-语句">yield from 语句</h3>

<h4 id="基本用法">基本用法</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sub_generator</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">子生成器</span><span class="sh">"""</span>
    <span class="k">yield</span> <span class="sh">"</span><span class="s">来自子生成器的值1</span><span class="sh">"</span>
    <span class="k">yield</span> <span class="sh">"</span><span class="s">来自子生成器的值2</span><span class="sh">"</span>
    <span class="k">yield</span> <span class="sh">"</span><span class="s">来自子生成器的值3</span><span class="sh">"</span>
    <span class="k">return</span> <span class="sh">"</span><span class="s">子生成器返回值</span><span class="sh">"</span>

<span class="k">def</span> <span class="nf">delegating_generator</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">委托生成器</span><span class="sh">"""</span>
    <span class="k">yield</span> <span class="sh">"</span><span class="s">开始</span><span class="sh">"</span>
    
    <span class="c1"># 使用 yield from 委托给子生成器
</span>    <span class="n">result</span> <span class="o">=</span> <span class="k">yield</span> <span class="k">from</span> <span class="nf">sub_generator</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">子生成器返回: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">yield</span> <span class="sh">"</span><span class="s">结束</span><span class="sh">"</span>

<span class="c1"># 使用委托生成器
</span><span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">delegating_generator</span><span class="p">():</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="复杂的-yield-from-示例">复杂的 yield from 示例</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">nested_list</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">扁平化嵌套列表</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">nested_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">yield</span> <span class="k">from</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>  <span class="c1"># 递归处理嵌套列表
</span>        <span class="k">else</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">item</span>

<span class="k">def</span> <span class="nf">chain_generators</span><span class="p">(</span><span class="o">*</span><span class="n">generators</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">链接多个生成器</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">gen</span> <span class="ow">in</span> <span class="n">generators</span><span class="p">:</span>
        <span class="k">yield</span> <span class="k">from</span> <span class="n">gen</span>

<span class="c1"># 测试扁平化
</span><span class="n">nested</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">flat_list</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nf">flatten</span><span class="p">(</span><span class="n">nested</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">扁平化结果: </span><span class="si">{</span><span class="n">flat_list</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 测试生成器链接
</span><span class="k">def</span> <span class="nf">gen1</span><span class="p">():</span>
    <span class="k">yield</span> <span class="mi">1</span>
    <span class="k">yield</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">gen2</span><span class="p">():</span>
    <span class="k">yield</span> <span class="mi">3</span>
    <span class="k">yield</span> <span class="mi">4</span>

<span class="k">def</span> <span class="nf">gen3</span><span class="p">():</span>
    <span class="k">yield</span> <span class="mi">5</span>
    <span class="k">yield</span> <span class="mi">6</span>

<span class="n">chained</span> <span class="o">=</span> <span class="nf">chain_generators</span><span class="p">(</span><span class="nf">gen1</span><span class="p">(),</span> <span class="nf">gen2</span><span class="p">(),</span> <span class="nf">gen3</span><span class="p">())</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">链接结果: </span><span class="si">{</span><span class="nf">list</span><span class="p">(</span><span class="n">chained</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="协程基础">协程基础</h3>

<h4 id="简单协程">简单协程</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">simple_coroutine</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">简单协程示例</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">协程启动</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">协程处理: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">协程结束</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_processor</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">数据处理协程</span><span class="sh">"""</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">break</span>
        
        <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">value</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">avg</span> <span class="o">=</span> <span class="n">total</span> <span class="o">/</span> <span class="n">count</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">接收: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">, 总和: </span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s">, 平均值: </span><span class="si">{</span><span class="n">avg</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">忽略非数字值: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 使用协程
</span><span class="n">coro</span> <span class="o">=</span> <span class="nf">data_processor</span><span class="p">()</span>
<span class="nf">next</span><span class="p">(</span><span class="n">coro</span><span class="p">)</span>  <span class="c1"># 启动协程
</span>
<span class="c1"># 发送数据
</span><span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="sh">"</span><span class="s">hello</span><span class="sh">"</span><span class="p">)</span>  <span class="c1"># 非数字值
</span><span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>  <span class="c1"># 结束协程
</span></code></pre></div></div>

<h4 id="协程装饰器">协程装饰器</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">coroutine_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">协程装饰器，自动启动协程</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">gen</span> <span class="o">=</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="nf">next</span><span class="p">(</span><span class="n">gen</span><span class="p">)</span>  <span class="c1"># 自动启动
</span>        <span class="k">return</span> <span class="n">gen</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@coroutine_decorator</span>
<span class="k">def</span> <span class="nf">auto_started_coroutine</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">自动启动的协程</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">协程已自动启动</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">处理: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 使用自动启动的协程
</span><span class="n">coro</span> <span class="o">=</span> <span class="nf">auto_started_coroutine</span><span class="p">()</span>
<span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="sh">"</span><span class="s">第一个值</span><span class="sh">"</span><span class="p">)</span>
<span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="sh">"</span><span class="s">第二个值</span><span class="sh">"</span><span class="p">)</span>
<span class="n">coro</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="实际应用场景">实际应用场景</h2>

<h3 id="1-大文件处理">1. 大文件处理</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">read_large_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">逐块读取大文件</span><span class="sh">"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="nb">file</span><span class="p">.</span><span class="nf">read</span><span class="p">(</span><span class="n">chunk_size</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">yield</span> <span class="n">chunk</span>
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">文件 </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> 不存在</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span>

<span class="k">def</span> <span class="nf">process_log_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">处理日志文件</span><span class="sh">"""</span>
    <span class="n">line_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">error_count</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="nb">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">file</span><span class="p">:</span>
                <span class="n">line_count</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># 处理每一行
</span>                <span class="k">if</span> <span class="sh">'</span><span class="s">ERROR</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="nf">upper</span><span class="p">():</span>
                    <span class="n">error_count</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">yield</span> <span class="p">{</span>
                        <span class="sh">'</span><span class="s">line_number</span><span class="sh">'</span><span class="p">:</span> <span class="n">line_count</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span> <span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">(),</span>
                        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">error</span><span class="sh">'</span>
                    <span class="p">}</span>
                <span class="k">elif</span> <span class="sh">'</span><span class="s">WARNING</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">line</span><span class="p">.</span><span class="nf">upper</span><span class="p">():</span>
                    <span class="k">yield</span> <span class="p">{</span>
                        <span class="sh">'</span><span class="s">line_number</span><span class="sh">'</span><span class="p">:</span> <span class="n">line_count</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span> <span class="n">line</span><span class="p">.</span><span class="nf">strip</span><span class="p">(),</span>
                        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">warning</span><span class="sh">'</span>
                    <span class="p">}</span>
                
                <span class="c1"># 每处理1000行报告一次进度
</span>                <span class="k">if</span> <span class="n">line_count</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="p">{</span>
                        <span class="sh">'</span><span class="s">line_number</span><span class="sh">'</span><span class="p">:</span> <span class="n">line_count</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">已处理 </span><span class="si">{</span><span class="n">line_count</span><span class="si">}</span><span class="s"> 行，发现 </span><span class="si">{</span><span class="n">error_count</span><span class="si">}</span><span class="s"> 个错误</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">progress</span><span class="sh">'</span>
                    <span class="p">}</span>
    
    <span class="k">except</span> <span class="nb">FileNotFoundError</span><span class="p">:</span>
        <span class="k">yield</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">line_number</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">文件 </span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s"> 不存在</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">error</span><span class="sh">'</span>
        <span class="p">}</span>

<span class="c1"># 创建示例日志文件
</span><span class="n">sample_log</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">INFO: 应用启动
DEBUG: 连接数据库
ERROR: 数据库连接失败
WARNING: 重试连接
INFO: 连接成功
ERROR: 查询超时
INFO: 应用关闭</span><span class="sh">"""</span>

<span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">'</span><span class="s">sample.log</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">w</span><span class="sh">'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">sample_log</span><span class="p">)</span>

<span class="c1"># 处理日志文件
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">处理日志文件:</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="nf">process_log_file</span><span class="p">(</span><span class="sh">'</span><span class="s">sample.log</span><span class="sh">'</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[</span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">].</span><span class="nf">upper</span><span class="p">()</span><span class="si">}</span><span class="s">] 行 </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">line_number</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2-数据流处理">2. 数据流处理</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DataPipeline</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">数据处理管道</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">processors</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span> <span class="nf">add_processor</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">processor</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">添加处理器</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">processors</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">processor</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">处理数据流</span><span class="sh">"""</span>
        <span class="n">current_stream</span> <span class="o">=</span> <span class="n">data_stream</span>
        
        <span class="k">for</span> <span class="n">processor</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">processors</span><span class="p">:</span>
            <span class="n">current_stream</span> <span class="o">=</span> <span class="nf">processor</span><span class="p">(</span><span class="n">current_stream</span><span class="p">)</span>
        
        <span class="k">yield</span> <span class="k">from</span> <span class="n">current_stream</span>

<span class="k">def</span> <span class="nf">data_source</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">数据源生成器</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">count</span><span class="p">):</span>
        <span class="k">yield</span> <span class="p">{</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">:</span> <span class="n">i</span><span class="p">,</span> <span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">:</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">raw</span><span class="sh">'</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">filter_processor</span><span class="p">(</span><span class="n">data_stream</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">过滤处理器</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">]</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># 只保留值能被4整除的项
</span>            <span class="k">yield</span> <span class="n">item</span>

<span class="k">def</span> <span class="nf">transform_processor</span><span class="p">(</span><span class="n">data_stream</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">转换处理器</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
        <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># 平方
</span>        <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">transformed</span><span class="sh">'</span>
        <span class="k">yield</span> <span class="n">item</span>

<span class="k">def</span> <span class="nf">validate_processor</span><span class="p">(</span><span class="n">data_stream</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">验证处理器</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">value</span><span class="sh">'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>  <span class="c1"># 验证值小于1000
</span>            <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">valid</span><span class="sh">'</span>
            <span class="k">yield</span> <span class="n">item</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="sh">'</span><span class="s">invalid</span><span class="sh">'</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">验证失败: </span><span class="si">{</span><span class="n">item</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 构建数据处理管道
</span><span class="n">pipeline</span> <span class="o">=</span> <span class="nc">DataPipeline</span><span class="p">()</span>
<span class="n">pipeline</span><span class="p">.</span><span class="nf">add_processor</span><span class="p">(</span><span class="n">filter_processor</span><span class="p">)</span>
<span class="n">pipeline</span><span class="p">.</span><span class="nf">add_processor</span><span class="p">(</span><span class="n">transform_processor</span><span class="p">)</span>
<span class="n">pipeline</span><span class="p">.</span><span class="nf">add_processor</span><span class="p">(</span><span class="n">validate_processor</span><span class="p">)</span>

<span class="c1"># 处理数据
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">数据处理管道结果:</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">pipeline</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="nf">data_source</span><span class="p">(</span><span class="mi">20</span><span class="p">)):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="3-状态机实现">3. 状态机实现</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StateMachine</span><span class="p">:</span>
    <span class="sh">"""</span><span class="s">基于生成器的状态机</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">context</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">events</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">运行状态机</span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">initial_state</span>
        <span class="n">state_gen</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">state</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">context</span><span class="p">)</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 启动状态
</span>            <span class="nf">next</span><span class="p">(</span><span class="n">state_gen</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">new_state</span> <span class="o">=</span> <span class="n">state_gen</span><span class="p">.</span><span class="nf">send</span><span class="p">(</span><span class="n">event</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">new_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                        <span class="c1"># 状态转换
</span>                        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">状态转换: </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">state</span><span class="p">.</span><span class="n">__name__</span><span class="si">}</span><span class="s"> -&gt; </span><span class="si">{</span><span class="n">new_state</span><span class="p">.</span><span class="n">__name__</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                        <span class="n">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">new_state</span>
                        <span class="n">state_gen</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">state</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">context</span><span class="p">)</span>
                        <span class="nf">next</span><span class="p">(</span><span class="n">state_gen</span><span class="p">)</span>  <span class="c1"># 启动新状态
</span>                
                <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
                    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">状态机结束</span><span class="sh">"</span><span class="p">)</span>
                    <span class="k">break</span>
        
        <span class="k">except</span> <span class="nb">StopIteration</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">状态机结束</span><span class="sh">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">idle_state</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">空闲状态</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">进入空闲状态</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">event</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">空闲状态收到事件: </span><span class="si">{</span><span class="n">event</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">start</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">working_state</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">shutdown</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">shutdown_state</span>

<span class="k">def</span> <span class="nf">working_state</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">工作状态</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">进入工作状态</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">context</span><span class="p">[</span><span class="sh">'</span><span class="s">work_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">work_count</span><span class="sh">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">event</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">工作状态收到事件: </span><span class="si">{</span><span class="n">event</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">work</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">context</span><span class="p">[</span><span class="sh">'</span><span class="s">work_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">完成工作，总计: </span><span class="si">{</span><span class="n">context</span><span class="p">[</span><span class="sh">'</span><span class="s">work_count</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">pause</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">paused_state</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">stop</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">idle_state</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">shutdown</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">shutdown_state</span>

<span class="k">def</span> <span class="nf">paused_state</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">暂停状态</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">进入暂停状态</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">event</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">暂停状态收到事件: </span><span class="si">{</span><span class="n">event</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">resume</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">working_state</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">stop</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">idle_state</span>
        <span class="k">elif</span> <span class="n">event</span> <span class="o">==</span> <span class="sh">'</span><span class="s">shutdown</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">shutdown_state</span>

<span class="k">def</span> <span class="nf">shutdown_state</span><span class="p">(</span><span class="n">context</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">关闭状态</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">进入关闭状态</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">最终工作计数: </span><span class="si">{</span><span class="n">context</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">work_count</span><span class="sh">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">return</span>  <span class="c1"># 结束状态机
</span>
<span class="c1"># 使用状态机
</span><span class="n">events</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">start</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">work</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">work</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">pause</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">resume</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">work</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">stop</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">shutdown</span><span class="sh">'</span><span class="p">]</span>

<span class="n">sm</span> <span class="o">=</span> <span class="nc">StateMachine</span><span class="p">()</span>
<span class="n">sm</span><span class="p">.</span><span class="nf">run</span><span class="p">(</span><span class="n">idle_state</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="4-网络爬虫">4. 网络爬虫</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">time</span>
<span class="kn">import</span> <span class="n">random</span>

<span class="k">def</span> <span class="nf">url_generator</span><span class="p">(</span><span class="n">base_urls</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">URL 生成器</span><span class="sh">"""</span>
    <span class="n">visited</span> <span class="o">=</span> <span class="nf">set</span><span class="p">()</span>
    <span class="n">queue</span> <span class="o">=</span> <span class="p">[(</span><span class="n">url</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">base_urls</span><span class="p">]</span>
    
    <span class="k">while</span> <span class="n">queue</span><span class="p">:</span>
        <span class="n">url</span><span class="p">,</span> <span class="n">depth</span> <span class="o">=</span> <span class="n">queue</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">visited</span> <span class="ow">or</span> <span class="n">depth</span> <span class="o">&gt;</span> <span class="n">max_depth</span><span class="p">:</span>
            <span class="k">continue</span>
        
        <span class="n">visited</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">url</span><span class="p">,</span> <span class="n">depth</span>
        
        <span class="c1"># 模拟发现新链接
</span>        <span class="k">if</span> <span class="n">depth</span> <span class="o">&lt;</span> <span class="n">max_depth</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span>
                <span class="n">new_url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="s">/page</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="sh">"</span>
                <span class="k">if</span> <span class="n">new_url</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">visited</span><span class="p">:</span>
                    <span class="n">queue</span><span class="p">.</span><span class="nf">append</span><span class="p">((</span><span class="n">new_url</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">web_crawler</span><span class="p">(</span><span class="n">urls</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">网络爬虫生成器</span><span class="sh">"""</span>
    <span class="k">for</span> <span class="n">url</span><span class="p">,</span> <span class="n">depth</span> <span class="ow">in</span> <span class="nf">url_generator</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">正在爬取 (深度 </span><span class="si">{</span><span class="n">depth</span><span class="si">}</span><span class="s">): </span><span class="si">{</span><span class="n">url</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># 模拟网络请求
</span>        <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">delay</span><span class="p">)</span>
        
        <span class="c1"># 模拟响应
</span>        <span class="n">response</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">url</span><span class="sh">'</span><span class="p">:</span> <span class="n">url</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">depth</span><span class="sh">'</span><span class="p">:</span> <span class="n">depth</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">content_length</span><span class="sh">'</span><span class="p">:</span> <span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">页面标题 - </span><span class="si">{</span><span class="n">url</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">yield</span> <span class="n">response</span>

<span class="c1"># 使用爬虫
</span><span class="n">base_urls</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">https://example.com</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">https://test.com</span><span class="sh">'</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">开始爬取:</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">page_data</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="nf">web_crawler</span><span class="p">(</span><span class="n">base_urls</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">] </span><span class="si">{</span><span class="n">page_data</span><span class="p">[</span><span class="sh">'</span><span class="s">title</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> - </span><span class="si">{</span><span class="n">page_data</span><span class="p">[</span><span class="sh">'</span><span class="s">content_length</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> bytes</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>  <span class="c1"># 限制爬取数量
</span>        <span class="k">break</span>
</code></pre></div></div>

<h2 id="常见陷阱与最佳实践">常见陷阱与最佳实践</h2>

<h3 id="1-生成器的一次性使用">1. 生成器的一次性使用</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ✗ 错误：尝试多次使用同一个生成器
</span><span class="k">def</span> <span class="nf">bad_example</span><span class="p">():</span>
    <span class="n">gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">第一次使用:</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">第二次使用:</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">gen</span><span class="p">:</span>  <span class="c1"># 这里不会输出任何内容
</span>        <span class="nf">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># ✓ 正确：每次创建新的生成器
</span><span class="k">def</span> <span class="nf">good_example</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">create_generator</span><span class="p">():</span>
        <span class="nf">return </span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">第一次使用:</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">create_generator</span><span class="p">():</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">第二次使用:</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">create_generator</span><span class="p">():</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="nf">bad_example</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span> <span class="o">+</span> <span class="sh">"</span><span class="s">=</span><span class="sh">"</span><span class="o">*</span><span class="mi">30</span> <span class="o">+</span> <span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">good_example</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="2-内存效率对比">2. 内存效率对比</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">sys</span>

<span class="k">def</span> <span class="nf">memory_comparison</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">内存使用对比</span><span class="sh">"""</span>
    
    <span class="c1"># 列表方式（占用大量内存）
</span>    <span class="n">large_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)]</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">列表大小: </span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="nf">getsizeof</span><span class="p">(</span><span class="n">large_list</span><span class="p">)</span><span class="si">}</span><span class="s"> bytes</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 生成器方式（占用很少内存）
</span>    <span class="n">large_gen</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">))</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">生成器大小: </span><span class="si">{</span><span class="n">sys</span><span class="p">.</span><span class="nf">getsizeof</span><span class="p">(</span><span class="n">large_gen</span><span class="p">)</span><span class="si">}</span><span class="s"> bytes</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 使用生成器处理大数据
</span>    <span class="k">def</span> <span class="nf">process_large_data</span><span class="p">():</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">large_gen</span><span class="p">:</span>
            <span class="n">total</span> <span class="o">+=</span> <span class="n">value</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="k">if</span> <span class="n">count</span> <span class="o">&gt;=</span> <span class="mi">1000</span><span class="p">:</span>  <span class="c1"># 只处理前1000个
</span>                <span class="k">break</span>
        
        <span class="k">return</span> <span class="n">total</span> <span class="o">/</span> <span class="n">count</span>
    
    <span class="n">avg</span> <span class="o">=</span> <span class="nf">process_large_data</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">前1000个数的平均值: </span><span class="si">{</span><span class="n">avg</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="nf">memory_comparison</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="3-异常处理最佳实践">3. 异常处理最佳实践</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">safe_generator</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">安全的生成器，包含异常处理</span><span class="sh">"""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">continue</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># 尝试处理每个项目
</span>                <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">item</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span>
                <span class="k">elif</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                    <span class="k">yield</span> <span class="n">item</span> <span class="o">*</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="sa">f</span><span class="sh">"</span><span class="s">未知类型: </span><span class="si">{</span><span class="nf">type</span><span class="p">(</span><span class="n">item</span><span class="p">).</span><span class="n">__name__</span><span class="si">}</span><span class="sh">"</span>
            
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># 处理单个项目的异常
</span>                <span class="k">yield</span> <span class="sa">f</span><span class="sh">"</span><span class="s">处理错误: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span>
    
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># 处理整体异常
</span>        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">生成器异常: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">yield</span> <span class="sh">"</span><span class="s">生成器发生错误</span><span class="sh">"</span>
    
    <span class="k">finally</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">生成器清理</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># 测试异常处理
</span><span class="n">test_data</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">hello</span><span class="sh">"</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="sh">"</span><span class="s">world</span><span class="sh">"</span><span class="p">]</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">安全生成器测试:</span><span class="sh">"</span><span class="p">)</span>
<span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="nf">safe_generator</span><span class="p">(</span><span class="n">test_data</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="4-性能优化技巧">4. 性能优化技巧</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="n">functools</span> <span class="kn">import</span> <span class="n">wraps</span>

<span class="k">def</span> <span class="nf">timing_decorator</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">计时装饰器</span><span class="sh">"""</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">func</span><span class="p">.</span><span class="n">__name__</span><span class="si">}</span><span class="s"> 执行时间: </span><span class="si">{</span><span class="n">end</span> <span class="o">-</span> <span class="n">start</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s"> 秒</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">return</span> <span class="n">wrapper</span>

<span class="nd">@timing_decorator</span>
<span class="k">def</span> <span class="nf">list_approach</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">列表方式</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="nd">@timing_decorator</span>
<span class="k">def</span> <span class="nf">generator_approach</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">生成器方式</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="nf">list</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>

<span class="nd">@timing_decorator</span>
<span class="k">def</span> <span class="nf">lazy_generator_approach</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">惰性生成器方式</span><span class="sh">"""</span>
    <span class="k">def</span> <span class="nf">gen</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="nf">gen</span><span class="p">()</span>

<span class="c1"># 性能测试
</span><span class="n">n</span> <span class="o">=</span> <span class="mi">100000</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">性能对比测试:</span><span class="sh">"</span><span class="p">)</span>
<span class="n">list_result</span> <span class="o">=</span> <span class="nf">list_approach</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">generator_result</span> <span class="o">=</span> <span class="nf">generator_approach</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">lazy_gen</span> <span class="o">=</span> <span class="nf">lazy_generator_approach</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">结果长度对比:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">列表长度: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">list_result</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">生成器转列表长度: </span><span class="si">{</span><span class="nf">len</span><span class="p">(</span><span class="n">generator_result</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">惰性生成器前10个: </span><span class="si">{</span><span class="p">[</span><span class="nf">next</span><span class="p">(</span><span class="n">lazy_gen</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="相关函数与模块">相关函数与模块</h2>

<h3 id="内置函数">内置函数</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">next()</code> - 获取生成器的下一个值</li>
  <li><code class="language-plaintext highlighter-rouge">iter()</code> - 创建迭代器</li>
  <li><code class="language-plaintext highlighter-rouge">enumerate()</code> - 枚举迭代器</li>
  <li><code class="language-plaintext highlighter-rouge">zip()</code> - 并行迭代多个序列</li>
</ul>

<h3 id="标准库模块">标准库模块</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">itertools</code> - 迭代器工具，提供强大的生成器功能</li>
  <li><code class="language-plaintext highlighter-rouge">functools</code> - 函数工具，包含生成器相关装饰器</li>
  <li><code class="language-plaintext highlighter-rouge">collections.abc</code> - 抽象基类，定义生成器接口</li>
  <li><code class="language-plaintext highlighter-rouge">asyncio</code> - 异步编程，基于协程</li>
</ul>

<h3 id="第三方库">第三方库</h3>
<ul>
  <li><code class="language-plaintext highlighter-rouge">more-itertools</code> - 扩展的迭代器工具</li>
  <li><code class="language-plaintext highlighter-rouge">toolz</code> - 函数式编程工具</li>
  <li><code class="language-plaintext highlighter-rouge">asyncio</code> - 异步生成器支持</li>
</ul>

<h2 id="扩展阅读">扩展阅读</h2>

<ul>
  <li><a href="https://docs.python.org/3/tutorial/classes.html#generators">Python 官方文档 - 生成器</a></li>
  <li><a href="https://www.python.org/dev/peps/pep-0255/">PEP 255 - Simple Generators</a></li>
  <li><a href="https://www.python.org/dev/peps/pep-0342/">PEP 342 - Coroutines via Enhanced Generators</a></li>
  <li><a href="https://www.python.org/dev/peps/pep-0380/">PEP 380 - Syntax for Delegating to a Subgenerator</a></li>
  <li><a href="https://docs.python.org/3/library/itertools.html">Python 官方文档 - itertools 模块</a></li>
</ul>

<h2 id="相关标签">相关标签</h2>

<p><code class="language-plaintext highlighter-rouge">Python</code> <code class="language-plaintext highlighter-rouge">生成器</code> <code class="language-plaintext highlighter-rouge">yield</code> <code class="language-plaintext highlighter-rouge">迭代器</code> <code class="language-plaintext highlighter-rouge">协程</code> <code class="language-plaintext highlighter-rouge">内存优化</code> <code class="language-plaintext highlighter-rouge">惰性求值</code> <code class="language-plaintext highlighter-rouge">函数式编程</code> <code class="language-plaintext highlighter-rouge">数据流处理</code></p>

      </div>
      
      <!-- 文档底部 -->
      <footer class="doc-footer">
        
        
        
      </footer>
    </article>
  </main>
  
  <!-- 右侧导航栏 -->
  <aside class="doc-sidebar">
    <div class="toc-container">
      <h3>目录</h3>
      <div id="toc"></div>
    </div>
    
    <!-- 相关链接 -->
    <div class="related-links">
      <h3>相关内容</h3>
      <ul>
        
        
      </ul>
    </div>
  </aside>
</div>

<!-- utterances评论系统 -->
<div class="comments-section">
  <h3 class="comments-title">
    <i class="fas fa-comments"></i>
    讨论与反馈
  </h3>
  <div class="comments-description">
    <p>欢迎在下方留言讨论，分享你的学习心得或提出问题。评论基于GitHub Issues，需要GitHub账号。</p>
  </div>
  <div id="utterances-container">
    <script src="https://utteranc.es/client.js"
            repo="username/PythonModelBook"
            issue-term="pathname"
            theme="preferred-color-scheme"
            crossorigin="anonymous"
            async>
    </script>
  </div>
  

</div>

<style>
.doc-container {
  display: flex;
  max-width: 1200px;
  margin: 0 auto;
  gap: 2rem;
}

.doc-content {
  flex: 1;
  min-width: 0;
}

.doc-header {
  border-bottom: 1px solid #e1e4e8;
  padding-bottom: 1rem;
  margin-bottom: 2rem;
}

.doc-title {
  font-size: 2.5rem;
  margin-bottom: 0.5rem;
  color: #24292e;
}

.doc-description {
  font-size: 1.2rem;
  color: #586069;
  margin-bottom: 1rem;
}

.doc-meta {
  display: flex;
  gap: 1rem;
  margin-bottom: 1rem;
  font-size: 0.9rem;
  color: #586069;
}

.doc-tags {
  display: flex;
  gap: 0.5rem;
  flex-wrap: wrap;
}

.tag {
  background: #f1f8ff;
  color: #0366d6;
  padding: 0.25rem 0.5rem;
  border-radius: 3px;
  font-size: 0.8rem;
}

.doc-body {
  line-height: 1.6;
}

.doc-body h2 {
  border-bottom: 1px solid #e1e4e8;
  padding-bottom: 0.3rem;
  margin-top: 2rem;
  margin-bottom: 1rem;
}

.doc-body pre {
  background: #f6f8fa;
  padding: 1rem;
  border-radius: 6px;
  overflow-x: auto;
}

.doc-body table {
  border-collapse: collapse;
  width: 100%;
  margin: 1rem 0;
}

.doc-body th,
.doc-body td {
  border: 1px solid #d0d7de;
  padding: 0.5rem;
  text-align: left;
}

.doc-body th {
  background: #f6f8fa;
  font-weight: 600;
}

.doc-sidebar {
  width: 300px;
  position: sticky;
  top: 2rem;
  height: fit-content;
}

.toc-container,
.related-links {
  background: #f6f8fa;
  padding: 1rem;
  border-radius: 6px;
  margin-bottom: 1rem;
}

.toc-container h3,
.related-links h3 {
  margin-top: 0;
  margin-bottom: 1rem;
  font-size: 1.1rem;
}

.related-links ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.related-links li {
  margin-bottom: 0.5rem;
}

.related-links a {
  color: #0366d6;
  text-decoration: none;
}

.related-links a:hover {
  text-decoration: underline;
}

.comments-section {
  max-width: 1200px;
  margin: 2rem auto;
  margin-top: 3rem;
  padding: 2rem;
  background: var(--bg-secondary, #f6f8fa);
  border-radius: var(--radius-xl, 12px);
  border: 1px solid var(--border-color, #e1e4e8);
}

.comments-title {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
  color: var(--text-primary, #24292e);
  font-size: 1.25rem;
  font-weight: 600;
}

.comments-title i {
  color: var(--primary-color, #0366d6);
}

.comments-description {
  margin-bottom: 1.5rem;
  padding: 1rem;
  background: var(--bg-primary, #ffffff);
  border-radius: var(--radius-lg, 8px);
  border-left: 4px solid var(--primary-color, #0366d6);
}

.comments-description p {
  margin: 0;
  color: var(--text-secondary, #586069);
  font-size: 0.9rem;
  line-height: 1.5;
}

#utterances-container,
#giscus-container {
  margin-top: 1rem;
}

/* 评论系统切换按钮 */
.comment-system-toggle {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 1rem;
  padding: 0.5rem;
  background: var(--bg-primary, #ffffff);
  border-radius: var(--radius-lg, 8px);
  border: 1px solid var(--border-color, #e1e4e8);
}

.comment-toggle-btn {
  flex: 1;
  padding: 0.5rem 1rem;
  background: transparent;
  border: none;
  border-radius: var(--radius-md, 6px);
  color: var(--text-secondary, #586069);
  font-size: 0.85rem;
  cursor: pointer;
  transition: all var(--transition-fast, 0.15s ease);
}

.comment-toggle-btn.active {
  background: var(--primary-color, #0366d6);
  color: var(--text-inverse, #ffffff);
}

.comment-toggle-btn:hover:not(.active) {
  background: var(--bg-secondary, #f6f8fa);
  color: var(--text-primary, #24292e);
}

@media (max-width: 768px) {
  .doc-container {
    flex-direction: column;
  }
  
  .doc-sidebar {
    width: 100%;
    position: static;
  }
}
</style>

<script>
// 生成目录
document.addEventListener('DOMContentLoaded', function() {
  const toc = document.getElementById('toc');
  const headings = document.querySelectorAll('.doc-body h2, .doc-body h3, .doc-body h4');
  
  if (headings.length > 0) {
    const tocList = document.createElement('ul');
    
    headings.forEach(function(heading, index) {
      const id = 'heading-' + index;
      heading.id = id;
      
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.href = '#' + id;
      a.textContent = heading.textContent;
      a.className = 'toc-link toc-' + heading.tagName.toLowerCase();
      
      li.appendChild(a);
      tocList.appendChild(li);
    });
    
    toc.appendChild(tocList);
  }
});

// 评论系统切换功能
function switchCommentSystem(system) {
  const utterancesContainer = document.getElementById('utterances-container');
  const giscusContainer = document.getElementById('giscus-container');
  
  if (system === 'giscus') {
    utterancesContainer.style.display = 'none';
    giscusContainer.style.display = 'block';
  } else {
    utterancesContainer.style.display = 'block';
    giscusContainer.style.display = 'none';
  }
}
</script>
  </main>

  <!-- 返回顶部按钮 -->
  <button id="back-to-top" class="back-to-top" title="返回顶部">
    <i class="fas fa-chevron-up"></i>
  </button>

  <!-- 页脚 -->
  <footer class="footer">
    <div class="footer-container">
      <div class="footer-content">
        <div class="footer-section">
          <h3>Python知识体系文档</h3>
          <p>系统化整理Python知识体系的开源项目</p>
        </div>
        <div class="footer-section">
          <h4>快速链接</h4>
          <ul>
            <li><a href="/PythonModelBook/docs/basics/">基础语法</a></li>
            <li><a href="/PythonModelBook/docs/builtins/">内置函数</a></li>
            <li><a href="/PythonModelBook/docs/stdlib/">标准库</a></li>
            <li><a href="/PythonModelBook/docs/thirdparty/">第三方库</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>社区</h4>
          <ul>
            <li><a href="https://github.com/liberalchang/PythonModelBook" target="_blank">GitHub</a></li>
            <li><a href="/PythonModelBook/CONTRIBUTING/">贡献指南</a></li>
            <li><a href="/PythonModelBook/about/">关于项目</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Python知识体系文档. 采用 <a href="/PythonModelBook/LICENSE">MIT License</a> 开源协议.</p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script src="/PythonModelBook/assets/js/main.js"></script>
  <script src="/PythonModelBook/assets/js/search.js"></script>
  
</body>

</html>